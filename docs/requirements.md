# 微信小程序 - 功能需求文档  

## 一、核心功能概览  

### 1. 管理端功能（管理员角色）
- **菜品管理**
  - 添加、编辑、删除菜品
  - 为每道菜品配置：
    - 图片
    - 简要描述（可选）
    - **分类标签**：如早餐/午餐/晚餐；主食/炒菜/汤品/海鲜等（可多选）
    - **食材清单**：每种食材名称、克重、单价（元/克）
- **数据导出/查看**（可选）
  - 导出当前所有菜品及其成本明细

### 2. 客户端功能（用户角色）
- **菜单浏览**
  - 查看完整菜单列表（图文卡片）
  - **侧边分类筛选**：左侧展示分类目录（早餐/午餐/晚餐；主食/炒菜/汤品/海鲜等），支持多选过滤
  - 支持按名称或标签搜索
- **菜品详情**
  - 大图、名称、简介
  - 分类标签展示
  - 食材成本明细与总成本计算
- **今日点菜**
  - 从菜单中选取当天要吃的菜品，添加到“今日菜谱”
  - 可查看当天已选菜品及其成本、小计总成本
- **评价/点赞**
  - 用户可对当天所吃菜品进行点赞（记录一次点赞，即“好吃”投票）
  - 在“今日菜谱”或菜品详情页提供“👍 点赞”按钮
  - 统计并展示每道菜的累计点赞数，用于判断“最受欢迎”菜品

## 二、页面与流程设计  

| 页面            | 角色      | 主要功能                                                             |
| --------------- | --------- | -------------------------------------------------------------------- |
| 启动页          | 全部      | 登录鉴权→判断管理员/用户身份→入口按钮（菜单/管理/今日菜谱）         |
| 菜单列表        | 用户      | 左侧分类+搜索→主区域列表（图文卡片）→点击进入菜品详情                |
| 菜品详情        | 用户      | 浏览菜品信息（含分类标签、成本明细）→“加入今日”/“点赞”             |
| 今日菜谱        | 用户      | 列出已选菜品→显示成本→“点赞”/查看累计点赞                          |
| 管理端菜单列表  | 管理员    | 列出所有菜品→分类筛选/搜索→编辑或删除                              |
| 添加/编辑菜品   | 管理员    | 填写菜名、图片、简介、分类、多行管理食材清单                         |
| 点赞排行榜（可选）| 全部     | 按点赞数排名→展示最受欢迎的菜品                                    |

## 三、数据模型设计  

### 1. 菜品（Dish）  
```json
{
  "id": number,
  "name": string,
  "imageUrl": string,
  "description": string,
  "categories": string[],       
  "ingredients": [
    {
      "name": string,
      "weightGrams": number,
      "unitPrice": number    
    }
  ],
  "totalCost": number,
  "likeCount": number       
}
```

### 2. 今日选择（TodaySelection）  
```json
[
  {
    "dishId": number,
    "timestamp": string      
  }
]
```

### 3. 点赞记录（可选扩展）  
```json
[
  {
    "dishId": number,
    "userId": string,
    "timestamp": string
  }
]
```

## 四、交互 & 权限流程  

1. **登录鉴权**：调用微信登录或云函数获取 `openid`，与预设管理员白名单比对，确定 `isAdmin` 标志。
2. **管理员视图**：`isAdmin === true` 时，导航栏或首页展示“管理入口”；普通用户不展示。
3. **分类过滤**：菜单列表左侧展示分类标签，用户可多选组合筛选。
4. **点赞控制**：
   - 限制每天每道菜只能点赞一次（可选）
   - 点赞后即时更新本地缓存与云端数据库。

## 五、部署与架构说明  

- **单一小程序**：推荐使用同一套代码，结合“角色鉴权”动态控制功能入口，无需单独开发两个版本。
  - 登录鉴权后，通过 `isAdmin` 标志展示或隐藏“管理端”页面
  - 用户端和管理端共用组件，复用菜单、详情页等通用模块
- **角色控制**：不同角色访问相同 `pages/` 路由，基于页面生命周期中判断角色权限进行逻辑分支

## 六、可选扩展  

- **多用户同步**：接入微信云开发，实现跨设备、多人协作编辑与浏览。
- **统计报表**：管理员可查看菜品成本报表、分类分布、点赞热度图、历史排行等。
- **评论功能**：在点赞基础上扩展文字评论。
- **分享功能**：分享菜单或今日菜谱到朋友圈/群聊。
